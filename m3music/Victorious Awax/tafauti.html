<!DOCTYPE html>
<html lang="fr">
<head>
  <!-- Google tag (gtag.js) -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-NZWFGJST12"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-NZWFGJST12');
  </script>

  <!-- Google Ads -->
  <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-7522765186794560" crossorigin="anonymous"></script>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>TafaUti - M3'Music</title>
  <link rel="stylesheet" href="../music.css" />
  <link rel="stylesheet" type="text/css" href="../lecteur.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css"/>
</head>
<body class="dark">
  <header class="music-header">
    <div class="logo-container">
      <img src="../m3-music.png" alt="Logo M3'Music">
      <h1><strong>M3'Music</strong> - <strong>TafaUti</strong></h1>
    </div>
    <nav class="nav-desktop">
      <ul>
        <li><a href="../music.html"><i class="fas fa-home"></i> Accueil</a></li>
        <li><a href="../albums.html"><i class="fas fa-compact-disc"></i> Albums</a></li>
        <li><a href="../artistes.html"><i class="fas fa-user"></i> Artistes</a></li>
        <li><a href="../clips.html"><i class="fas fa-video"></i> Clips</a></li>
      </ul>
    </nav>
  </header>

  <main class="music-content" style="background-image: url('TafaUti/tafauti.jpg');">
    <h2><strong>Victorious Awax - TafaUti</strong></h2>

    <section class="audio-player">
      <div class="track-info">
        <img id="cover" src="cover.jpg" alt="Pochette">
        <div>
          <h3 id="title">Titre</h3>
          <p id="artist">Artiste</p>
          <p id="album">Album</p>
        </div>
      </div>

      <audio id="audio"></audio>

      <div class="controls">
        <button id="prev"><i class="fas fa-backward"></i></button>
        <button id="play"><i class="fas fa-play"></i></button>
        <button id="next"><i class="fas fa-forward"></i></button>
        <button id="mode" title="Mode de lecture"><i class="fas fa-music"></i></button>
        <div>
        <input type="range" id="progress" value="0">
        <input type="range" id="volume" min="0" max="1" step="0.01" value="1">
        </div>
      </div>

      <button id="download-all"><i class="fas fa-download"></i> Télécharger toutes les musiques</button>
    </section>

    <div class="playlist" id="playlist"></div>
  </main>

  <nav class="nav-mobile">
    <a href="../music.html"><i class="fas fa-home"></i><span>Accueil</span></a>
    <a href="../albums.html"><i class="fas fa-compact-disc"></i><span>Albums</span></a>
    <a href="../artistes.html"><i class="fas fa-user"></i><span>Artistes</span></a>
    <a href="../clips.html"><i class="fas fa-video"></i><span>Clips</span></a>
  </nav>

  <script>
    const playlist = [
      { title: "1. Intro", artist: "Victorious Awax", album: "TafaUti", src: "TafaUti/1. Victorious Awax - Intro.mp3", cover: "TafaUti/tafauti.jpg" },
      { title: "2. TafaUti", artist: "Victorious Awax", album: "TafaUti", src: "TafaUti/2. Victorious Awax - TafaUti.mp3", cover: "TafaUti/tafauti.jpg" },
      { title: "3. Kamili feat Jetcn & AST", artist: "Victorious Awax", album: "TafaUti", src: "TafaUti/3. Victorious Awax - Kamili feat Jetcn & AST.mp3", cover: "TafaUti/tafauti.jpg" },
      { title: "4. Nipare", artist: "Victorious Awax", album: "TafaUti", src: "TafaUti/4. Victorious Awax - Nipare.mp3", cover: "TafaUti/tafauti.jpg" },
      { title: "5. Hani Wuwa", artist: "Victorious Awax", album: "TafaUti", src: "TafaUti/5. Victorious Awax - Hani Wuwa.mp3", cover: "TafaUti/tafauti.jpg" },
      { title: "6. Mwendje feat Hawmi", artist: "Victorious Awax", album: "TafaUti", src: "TafaUti/6. Victorious Awax - Mwendje feat Hawmi.mp3", cover: "TafaUti/tafauti.jpg" },
      { title: "7. Yeka Tsi Ndami Ndo feat Criminal Team", artist: "Victorious Awax", album: "TafaUti", src: "TafaUti/7. Victorious Awax - Yeka Tsi Ndami Ndo feat Criminal Team.mp3", cover: "TafaUti/tafauti.jpg" },
      { title: "8. Wa Zamani feat Lil Simba", artist: "Victorious Awax", album: "TafaUti", src: "TafaUti/8. Victorious Awax - Wa Zamani feat Lil Simba.mp3", cover: "TafaUti/tafauti.jpg" },
      { title: "9. Tsi Haba feat Lemir", artist: "Victorious Awax", album: "TafaUti", src: "TafaUti/9. Victorious Awax - Tsi Haba feat Lemir.mp3", cover: "TafaUti/tafauti.jpg" },
      { title: "10. Maskini Hale", artist: "Victorious Awax", album: "TafaUti", src: "TafaUti/10. Victorious Awax - Maskini Hale.mp3", cover: "TafaUti/tafauti.jpg" }
    ];

    let currentTrack = 0;
    let mode = "normal"; // "normal", "shuffle", "loop"

    const audio = document.getElementById("audio");
    const cover = document.getElementById("cover");
    const title = document.getElementById("title");
    const artist = document.getElementById("artist");
    const album = document.getElementById("album");

    const playBtn = document.getElementById("play");
    const nextBtn = document.getElementById("next");
    const prevBtn = document.getElementById("prev");
    const modeBtn = document.getElementById("mode");
    const volume = document.getElementById("volume");
    const progress = document.getElementById("progress");

    const playlistContainer = document.getElementById("playlist");

    function loadTrack(index) {
      const track = playlist[index];
      audio.src = track.src;
      cover.src = track.cover || "cover.jpg";
      title.textContent = track.title;
      artist.textContent = track.artist;
      album.textContent = track.album;
      audio.play();
      playBtn.innerHTML = '<i class="fas fa-pause"></i>';
    }

    function renderPlaylist() {
      playlistContainer.innerHTML = "";
      playlist.forEach((track, index) => {
        const item = document.createElement("div");
        item.className = "playlist-item";
        item.innerHTML = `
          <p>${track.title} - ${track.artist}</p>
          <a href="${track.src}" download><i class="fas fa-download"></i></a>
        `;
        item.onclick = () => {
          currentTrack = index;
          loadTrack(currentTrack);
        };
        playlistContainer.appendChild(item);
      });
    }

    playBtn.onclick = () => {
      if (audio.paused) {
        audio.play();
        playBtn.innerHTML = '<i class="fas fa-pause"></i>';
      } else {
        audio.pause();
        playBtn.innerHTML = '<i class="fas fa-play"></i>';
      }
    };

    nextBtn.onclick = () => {
      currentTrack = (currentTrack + 1) % playlist.length;
      loadTrack(currentTrack);
    };

    prevBtn.onclick = () => {
      currentTrack = (currentTrack - 1 + playlist.length) % playlist.length;
      loadTrack(currentTrack);
    };

    modeBtn.onclick = () => {
      if (mode === "normal") {
        mode = "shuffle";
        modeBtn.innerHTML = '<i class="fas fa-random"></i>';
      } else if (mode === "shuffle") {
        mode = "loop";
        modeBtn.innerHTML = '<i class="fas fa-redo"></i>';
      } else {
        mode = "normal";
        modeBtn.innerHTML = '<i class="fas fa-music"></i>';
      }
    };

    audio.addEventListener("ended", () => {
      if (mode === "loop") {
        audio.currentTime = 0;
        audio.play();
      } else if (mode === "shuffle") {
        let nextTrack;
        do {
          nextTrack = Math.floor(Math.random() * playlist.length);
        } while (nextTrack === currentTrack);
        currentTrack = nextTrack;
        loadTrack(currentTrack);
      } else {
        nextBtn.click();
      }
    });

    volume.oninput = () => {
      audio.volume = volume.value;
    };

    audio.ontimeupdate = () => {
      progress.value = (audio.currentTime / audio.duration) * 100 || 0;
    };

    progress.oninput = () => {
      audio.currentTime = (progress.value / 100) * audio.duration;
    };

    document.getElementById("download-all").onclick = () => {
      playlist.forEach(track => {
        const link = document.createElement("a");
        link.href = track.src;
        link.download = track.src.split("/").pop();
        document.body.appendChild(link);
        link.click();
        document.body.removeChild(link);
      });
    };

    // Initialisation
    renderPlaylist();
    loadTrack(currentTrack);
  </script>
</body>
</html>
