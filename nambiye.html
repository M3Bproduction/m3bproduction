<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Tommy 10 - NambiyÃ©</title>
  <link rel="stylesheet" type="text/css" href="playlist.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
</head>
<body>
  <div class="audio-player" class="mini">
    <div class="track-info">
      <img id="coverImage" src="" alt="Pochette" class="cover">
      <div class="meta">
        <h3 id="trackTitle">Titre</h3>
        <p id="trackArtist">Artiste</p>
        <p id="trackAlbum">Album</p>
      </div>
      <audio id="myAudio"></audio>
    </div>
  
  <div class="controls">
    <button id="prevBtn">â®ï¸</button>
    <button id="playBtn">â–¶ï¸</button>
    <button id="nextBtn">â­ï¸</button>
    <button id="loopBtn">ğŸ”</button>
    <input type="range" id="volumeControl" min="0" max="1" step="0.01" value="1" class="volume">
  </div>

  <div class="progress-container">
    <div class="progress-bar" id="progressBar"></div>
  </div>

  <div class="time-display">
    <span id="currentTime">0:00</span>
    <span id="totalTime">0:00</span>
  </div>

  <button class="mode-toggle" id="toggleMode">ğŸŒ“ Mode Sombre</button>
<button id="downloadAllBtn" class="download-all">ğŸ“¥ TÃ©lÃ©charger</button>
</div>
<div class="playlist" id="playlist"></div>

<script>
  const audio = document.getElementById("myAudio");
  const playBtn = document.getElementById("playBtn");
  const progressBar = document.getElementById("progressBar");
  const progressContainer = document.querySelector(".progress-container");
  const volumeControl = document.getElementById("volumeControl");
  const currentTimeEl = document.getElementById("currentTime");
  const totalTimeEl = document.getElementById("totalTime");
  const loopBtn = document.getElementById("loopBtn");
  let playMode = "normal"; // normal, repeat, shuffle, stop
  const prevBtn = document.getElementById("prevBtn");
  const nextBtn = document.getElementById("nextBtn");
  const toggleModeBtn = document.getElementById("toggleMode");

  // Playlist (exemple avec 2 musiques)
  const playlist = [
    {src: "NambiyÃ©/1 - Tommy 10 - NambiyÃ©.mp3",title: "1. NambiyÃ©",artist: "Tommy 10",album: "NambiyÃ©",cover: "Cover/Nambiye.webp"},
    {src: "NambiyÃ©/2 - Tommy 10 - Yenda(feat J-ga Frees).mp3",title: "2. Yenda (feat J-ga Frees)",artist: "Tommy 10",album: "NambiyÃ©",cover: "Cover/Nambiye.webp"},
    {src: "NambiyÃ©/3 - Tommy 10 - Ndjadaza(feat Gueriya).mp3",title: "3. Ndjadaza (feat Gueriya)",artist: "Tommy 10",album: "NambiyÃ©",cover: "Cover/Nambiye.webp"},
    {src: "NambiyÃ©/4 - Tommy 10 - Ndopvi(feat Benzaher).mp3",title: "4. Ndopvi (feat Benzaher)",artist: "Tommy 10",album: "NambiyÃ©",cover: "Cover/Nambiye.webp"},
    {src: "NambiyÃ©/5 - Tommy 10 - Mi Ntsoumdrani.mp3",title: "5. Mi Ntsoumdrani",artist: "Tommy 10",album: "NambiyÃ©",cover: "Cover/Nambiye.webp"},
    {src: "NambiyÃ©/6 - Tommy 10 - Freestyle 1(Ndo wussiku nazaloi).mp3",title: "6. Freestyle 1 (Ndo wussiku nazaloi)",artist: "Tommy 10",album: "NambiyÃ©",cover: "Cover/Nambiye.webp"},
    {src: "NambiyÃ©/7 - Tommy 10 - Outro.mp3",title: "7. Outro",artist: "Tommy 10",album: "NambiyÃ©",cover: "Cover/Nambiye.webp"}
];

  let currentTrack = 0;

  function loadTrack(index) {
  const track = playlist[index];
  audio.src = track.src;
  document.getElementById("trackTitle").textContent = track.title;
  document.getElementById("trackArtist").textContent = track.artist;
  document.getElementById("trackAlbum").textContent = track.album;
  document.getElementById("coverImage").src = track.cover;
  audio.load();
  audio.play();
  playBtn.textContent = "â¸";
}

  // Formatage du temps
  function formatTime(seconds) {
    const min = Math.floor(seconds / 60);
    const sec = Math.floor(seconds % 60).toString().padStart(2, '0');
    return `${min}:${sec}`;
  }

  playBtn.addEventListener("click", () => {
    if (audio.paused) {
      audio.play();
      playBtn.textContent = "â¸";
    } else {
      audio.pause();
      playBtn.textContent = "â–¶ï¸";
    }
  });

  // Barre de progression
  audio.addEventListener("timeupdate", () => {
    const progressPercent = (audio.currentTime / audio.duration) * 100;
    progressBar.style.width = `${progressPercent}%`;
    currentTimeEl.textContent = formatTime(audio.currentTime);
    totalTimeEl.textContent = formatTime(audio.duration);
  });

  progressContainer.addEventListener("click", (e) => {
    const width = progressContainer.clientWidth;
    const clickX = e.offsetX;
    const duration = audio.duration;
    audio.currentTime = (clickX / width) * duration;
  });

  // Volume
  volumeControl.addEventListener("input", () => {
    audio.volume = volumeControl.value;
  });

  // Loop
  loopBtn.addEventListener("click", () => {
  if (playMode === "normal") {
    playMode = "repeat";
    loopBtn.textContent = "ğŸ”‚";
  } else if (playMode === "repeat") {
    playMode = "shuffle";
    loopBtn.textContent = "ğŸ”€";
  } else if (playMode === "shuffle") {
    playMode = "stop";
    loopBtn.textContent = "â¹ï¸";
  } else {
    playMode = "normal";
    loopBtn.textContent = "ğŸ”";
  }
});

  // Playlist navigation
  prevBtn.addEventListener("click", () => {
    currentTrack = (currentTrack - 1 + playlist.length) % playlist.length;
    loadTrack(currentTrack);
  });

  nextBtn.addEventListener("click", () => {
    currentTrack = (currentTrack + 1) % playlist.length;
    loadTrack(currentTrack);
  });

  // Auto-play next
  audio.addEventListener("ended", () => {
  if (playMode === "repeat") {
    audio.currentTime = 0;
    audio.play();
  } else if (playMode === "shuffle") {
    let nextTrack;
    do {
      nextTrack = Math.floor(Math.random() * playlist.length);
    } while (nextTrack === currentTrack && playlist.length > 1);
    currentTrack = nextTrack;
    loadTrack(currentTrack);
  } else if (playMode === "normal") {
    if (currentTrack < playlist.length - 1) {
      currentTrack++;
      loadTrack(currentTrack);
    }
  }
  // Si mode = stop â†’ ne rien faire
});

  // Mode sombre
  toggleModeBtn.addEventListener("click", () => {
    document.body.classList.toggle("dark-mode");
  });

  // Chargement initial
  audio.addEventListener("loadedmetadata", () => {
    totalTimeEl.textContent = formatTime(audio.duration);
  });

  const playlistContainer = document.getElementById("playlist");

// GÃ©nÃ©rer les items
function renderPlaylist() {
  playlistContainer.innerHTML = "";

  playlist.forEach((track, index) => {
    const item = document.createElement("div");
    item.classList.add("playlist-item");
    item.textContent = `${track.title} - ${track.artist}`;

    if (index === currentTrack) {
      item.classList.add("active");
    }

    item.addEventListener("click", () => {
      currentTrack = index;
      loadTrack(currentTrack);
      updateActiveTrack();
    });

    playlistContainer.appendChild(item);
  });
}

// Mettre Ã  jour le style actif
function updateActiveTrack() {
  const items = document.querySelectorAll(".playlist-item");
  items.forEach((item, index) => {
    item.classList.toggle("active", index === currentTrack);
  });
}

// Bouton pour tÃ©lÃ©charger tous les morceaux
const downloadAllBtn = document.getElementById("downloadAllBtn");

downloadAllBtn.addEventListener("click", () => {
  playlist.forEach(track => {
    const link = document.createElement("a");
    link.href = track.src;
    link.download = track.src.split("/").pop(); // nom du fichier
    link.style.display = "none";
    document.body.appendChild(link);
    link.click();
    document.body.removeChild(link);
  });
});

  // Auto load le premier morceau
  renderPlaylist();
  loadTrack(currentTrack);

  function loadTrack(index) {
  const track = playlist[index];
  audio.src = track.src;
  document.getElementById("trackTitle").textContent = track.title;
  document.getElementById("trackArtist").textContent = track.artist;
  document.getElementById("trackAlbum").textContent = track.album;
  document.getElementById("coverImage").src = track.cover;
  audio.load();
  audio.play();
  playBtn.textContent = "â¸";
  updateActiveTrack(); // <<< AJOUT
}
</script>
</body>
</html>