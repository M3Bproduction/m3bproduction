<!DOCTYPE html>
<html>
	<head>
		<!-- Google tag (gtag.js) -->
		<script async src="https://www.googletagmanager.com/gtag/js?id=G-NZWFGJST12"></script>
		<script>
		  window.dataLayer = window.dataLayer || [];
		  function gtag(){dataLayer.push(arguments);}
		  gtag('js', new Date());

		  gtag('config', 'G-NZWFGJST12');
		</script>
		<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-7522765186794560"
     	crossorigin="anonymous"></script>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1">
		<title>Tommy 10 - Nambiy√©</title>
		<link rel="stylesheet" type="text/css" href="playlist.css">
		<link rel="stylesheet" type="text/css" href="styles.css">
	  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <link rel="icon" type="image/x-icon" href="favicon.ico">
	</head>

	<body>
		<header class="top-nav">
			<div class="logo">
				<img src="M3Music.webp" alt="Logo M3'STREAM" class="logo-img">
				<h2>M3 Music</h2>
			</div>
			<nav class="main-nav top-nav-links">
				<ul>
			    	<li><a href="index.html">Accueil</a></li>
				    <li><a href="clips.html">Clips</a></li>
				    <li><a href="albums.html">Albums</a></li>
				    <li><a href="a-propos.html">√Ä propos</a></li>
				  </ul>
			</nav>
		</header>
		<div class="logo-m">
			<img src="M3Music.webp" alt="Logo M3'STREAM" class="logo-img">
			<h2>M3 Music</h2>
		</div>

		<main>
	  		<div class="audio-player" class="mini">
	    		<div class="track-info">
	      			<img id="coverImage" src="" alt="Pochette" class="cover">
	      			<div class="meta">
	        			<h3 id="trackTitle">Titre</h3>
	        			<p id="trackArtist">Artiste</p>
	        			<p id="trackAlbum">Album</p>
	      			</div>
	      			<audio id="myAudio"></audio>
	    		</div>
	  
	  			<div class="controls">
	    			<button id="prevBtn">‚èÆÔ∏è</button>
	    			<button id="playBtn">‚ñ∂Ô∏è</button>
	    			<button id="nextBtn">‚è≠Ô∏è</button>
	    			<button id="loopBtn">üîÅ</button>
	    			<input type="range" id="volumeControl" min="0" max="1" step="0.01" value="1" class="volume">
	  			</div>

	  			<div class="progress-container">
	    			<div class="progress-bar" id="progressBar"></div>
	  			</div>

	  			<div class="time-display">
	    			<span id="currentTime">0:00</span>
	    			<span id="totalTime">0:00</span>
	  			</div>

	  			<button class="mode-toggle" id="toggleMode">üåì Mode Sombre</button>
				<button id="downloadAllBtn" class="download-all">üì• T√©l√©charger</button>
			</div>
			<div class="playlist" id="playlist"></div>
		</main>

		<footer>
			<!-- Barre de navigation fixe en bas -->
			<nav class="bottom-nav">
				<a href="index.html" class="nav-link">
					<span class="material-icons">home</span>
				    <span>Accueil</span>
				</a>
				<a href="clips.html" class="nav-link">
				    <span class="material-icons">movie</span>
				    <span>Clips</span>
				</a>
				<a href="albums.html" class="nav-link">
				    <span class="material-icons">album</span>
				    <span>Albums</span>
				</a>
				<a href="a-propos.html" class="nav-link">
				    <span class="material-icons">info</span>
				    <span>√Ä propos</span>
				</a>
			</nav>
		</footer>

		<script>
		  const audio = document.getElementById("myAudio");
		  const playBtn = document.getElementById("playBtn");
		  const progressBar = document.getElementById("progressBar");
		  const progressContainer = document.querySelector(".progress-container");
		  const volumeControl = document.getElementById("volumeControl");
		  const currentTimeEl = document.getElementById("currentTime");
		  const totalTimeEl = document.getElementById("totalTime");
		  const loopBtn = document.getElementById("loopBtn");
		  let playMode = "normal"; // normal, repeat, shuffle, stop
		  const prevBtn = document.getElementById("prevBtn");
		  const nextBtn = document.getElementById("nextBtn");
		  const toggleModeBtn = document.getElementById("toggleMode");

		  // Playlist
		  const playlist = [
		    {src: "Nambiy√©/1 - Tommy 10 - Nambiy√©.mp3",title: "1. Nambiy√©",artist: "Tommy 10",album: "Nambiy√©",cover: "Cover/Nambiye.webp"},
		    {src: "Nambiy√©/2 - Tommy 10 - Yenda(feat J-ga Frees).mp3",title: "2. Yenda (feat J-ga Frees)",artist: "Tommy 10",album: "Nambiy√©",cover: "Cover/Nambiye.webp"},
		    {src: "Nambiy√©/3 - Tommy 10 - Ndjadaza(feat Gueriya).mp3",title: "3. Ndjadaza (feat Gueriya)",artist: "Tommy 10",album: "Nambiy√©",cover: "Cover/Nambiye.webp"},
		    {src: "Nambiy√©/4 - Tommy 10 - Ndopvi(feat Benzaher).mp3",title: "4. Ndopvi (feat Benzaher)",artist: "Tommy 10",album: "Nambiy√©",cover: "Cover/Nambiye.webp"},
		    {src: "Nambiy√©/5 - Tommy 10 - Mi Ntsoumdrani.mp3",title: "5. Mi Ntsoumdrani",artist: "Tommy 10",album: "Nambiy√©",cover: "Cover/Nambiye.webp"},
		    {src: "Nambiy√©/6 - Tommy 10 - Freestyle 1(Ndo wussiku nazaloi).mp3",title: "6. Freestyle 1 (Ndo wussiku nazaloi)",artist: "Tommy 10",album: "Nambiy√©",cover: "Cover/Nambiye.webp"},
		    {src: "Nambiy√©/7 - Tommy 10 - Outro.mp3",title: "7. Outro",artist: "Tommy 10",album: "Nambiy√©",cover: "Cover/Nambiye.webp"}
			];

		  let currentTrack = 0;

		  function loadTrack(index) {
		  const track = playlist[index];
		  audio.src = track.src;
		  document.getElementById("trackTitle").textContent = track.title;
		  document.getElementById("trackArtist").textContent = track.artist;
		  document.getElementById("trackAlbum").textContent = track.album;
		  document.getElementById("coverImage").src = track.cover;
		  audio.load();
		  audio.play();
		  playBtn.textContent = "‚è∏";
		  }

		  // Formatage du temps
		  function formatTime(seconds) {
		    const min = Math.floor(seconds / 60);
		    const sec = Math.floor(seconds % 60).toString().padStart(2, '0');
		    return `${min}:${sec}`;
		  }

		  playBtn.addEventListener("click", () => {
		    if (audio.paused) {
		      audio.play();
		      playBtn.textContent = "‚è∏";
		    } else {
		      audio.pause();
		      playBtn.textContent = "‚ñ∂Ô∏è";
		    }
		  });

		  // Barre de progression
		  audio.addEventListener("timeupdate", () => {
		    const progressPercent = (audio.currentTime / audio.duration) * 100;
		    progressBar.style.width = `${progressPercent}%`;
		    currentTimeEl.textContent = formatTime(audio.currentTime);
		    totalTimeEl.textContent = formatTime(audio.duration);
		  });

		  progressContainer.addEventListener("click", (e) => {
		    const width = progressContainer.clientWidth;
		    const clickX = e.offsetX;
		    const duration = audio.duration;
		    audio.currentTime = (clickX / width) * duration;
		  });

		  // Volume
		  volumeControl.addEventListener("input", () => {
		    audio.volume = volumeControl.value;
		  });

		  // Loop
		  loopBtn.addEventListener("click", () => {
		  if (playMode === "normal") {
		    playMode = "repeat";
		    loopBtn.textContent = "üîÇ";
		  } else if (playMode === "repeat") {
		    playMode = "shuffle";
		    loopBtn.textContent = "üîÄ";
		  } else if (playMode === "shuffle") {
		    playMode = "stop";
		    loopBtn.textContent = "‚èπÔ∏è";
		  } else {
		    playMode = "normal";
		    loopBtn.textContent = "üîÅ";
		  }
		  });

		  // Playlist navigation
		  prevBtn.addEventListener("click", () => {
		    currentTrack = (currentTrack - 1 + playlist.length) % playlist.length;
		    loadTrack(currentTrack);
		  });

		  nextBtn.addEventListener("click", () => {
		    currentTrack = (currentTrack + 1) % playlist.length;
		    loadTrack(currentTrack);
		  });

		  // Auto-play next
		  audio.addEventListener("ended", () => {
		  if (playMode === "repeat") {
		    audio.currentTime = 0;
		    audio.play();
		  } else if (playMode === "shuffle") {
		    let nextTrack;
		    do {
		      nextTrack = Math.floor(Math.random() * playlist.length);
		    } while (nextTrack === currentTrack && playlist.length > 1);
		    currentTrack = nextTrack;
		    loadTrack(currentTrack);
		  } else if (playMode === "normal") {
		    if (currentTrack < playlist.length - 1) {
		      currentTrack++;
		      loadTrack(currentTrack);
		    }
		  }
		  // Si mode = stop ‚Üí ne rien faire
		  });

		  // Mode sombre
		  toggleModeBtn.addEventListener("click", () => {
		    document.body.classList.toggle("dark-mode");
		  });

		  // Chargement initial
		  audio.addEventListener("loadedmetadata", () => {
		    totalTimeEl.textContent = formatTime(audio.duration);
		  });

		  const playlistContainer = document.getElementById("playlist");

		  // G√©n√©rer les items
		  function renderPlaylist() {
  playlistContainer.innerHTML = "";

  playlist.forEach((track, index) => {
    const item = document.createElement("div");
    item.classList.add("playlist-item");

    // Contenu texte
    const text = document.createElement("span");
    text.textContent = `${track.title} - ${track.artist}`;
    text.classList.add("track-title");

    // Bouton t√©l√©charger
    const downloadBtn = document.createElement("a");
    downloadBtn.href = track.src;
    downloadBtn.download = track.src.split("/").pop(); // nom du fichier
    downloadBtn.textContent = "üì•";
    downloadBtn.classList.add("download-btn");
    downloadBtn.title = "T√©l√©charger ce morceau";

    // Clic sur le texte lance la lecture
    text.addEventListener("click", () => {
      currentTrack = index;
      loadTrack(currentTrack);
      updateActiveTrack();
    });

    // Ajouter les deux √©l√©ments au bloc
    item.appendChild(text);
    item.appendChild(downloadBtn);

    if (index === currentTrack) {
      item.classList.add("active");
    }

    playlistContainer.appendChild(item);
  });
}

		  // Mettre √† jour le style actif
		  function updateActiveTrack() {
		  const items = document.querySelectorAll(".playlist-item");
		  items.forEach((item, index) => {
		    item.classList.toggle("active", index === currentTrack);
		  });
		  }

		  // Bouton pour t√©l√©charger tous les morceaux
		  const downloadAllBtn = document.getElementById("downloadAllBtn");

		  downloadAllBtn.addEventListener("click", () => {
		  playlist.forEach(track => {
		    const link = document.createElement("a");
		    link.href = track.src;
		    link.download = track.src.split("/").pop(); // nom du fichier
		    link.style.display = "none";
		    document.body.appendChild(link);
		    link.click();
		    document.body.removeChild(link);
		  });
		  });

		  // Auto load le premier morceau
		  renderPlaylist();
		  loadTrack(currentTrack);

		  function loadTrack(index) {
		  const track = playlist[index];
		  audio.src = track.src;
		  document.getElementById("trackTitle").textContent = track.title;
		  document.getElementById("trackArtist").textContent = track.artist;
		  document.getElementById("trackAlbum").textContent = track.album;
		  document.getElementById("coverImage").src = track.cover;
		  audio.load();
		  audio.play();
		  playBtn.textContent = "‚è∏";
		  updateActiveTrack(); // <<< AJOUT
		  }
		</script>
	</body>
</html>